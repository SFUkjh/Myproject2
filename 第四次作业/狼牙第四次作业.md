#狼牙第四次任务  
##任务一： 卡尔曼滤波器公式推导与参数解释  
见图  
![kalman1234](https://github.com/SFUkjh/Myproject2/tree/main/%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/Kalman)
  
##任务二：    
不知道为什么我的电脑打开给出的cpp是一堆乱码。。。正好暑假培训做了卡尔曼相关的任务，就在暑假作业的基础上改进了一些。 
###1、  
		
任务一要求构造一个一维匀速运动的卡尔曼滤波器。我的模型是一个起始位置为0，速度为2m/s匀速运动模型，噪声服从分别为（0,1）和（0,10）。  
首先定义一个 kf 函数，它使用传入的测量值 m 来执行卡尔曼滤波。函数中定义了一些参数和变量，包括状态转移矩阵 F、过程噪声协方差矩阵 Q、测量矩阵 H、观测噪声协方差矩阵 R、系统状态矩阵 P、滤波后的状态矩阵 s 等。

在 kf 函数中，对每个测量值  
1、先使用状态转移矩阵 F 和初始状态 s 计算预测状态 s。   
2. 使用状态转移矩阵 F、系统状态矩阵 P 和其转置，以及过程噪声协方差矩阵 Q，更新系统状态矩阵 P。  
3. 将当前测量值加上高斯噪声后的值 mea，与预测状态之间的差异计算出测量残差 y。  
4. 使用测量矩阵 H、系统状态矩阵 P 和观测噪声协方差矩阵 R，计算测量残差的方差 S。  
5. 使用系统状态矩阵 P、测量矩阵 H 和测量方差 S，计算卡尔曼增益 K。  
6. 使用卡尔曼增益 K 和测量残差 y，更新系统状态矩阵 s。  
7. 使用卡尔曼增益 K 和测量矩阵 H，更新系统状态矩阵 P。  

最后，将每个时刻的滤波后的状态保存到一个矩阵 f 中，并返回该矩阵。


在 main 函数中，首先生成一些模拟数据，包括真实状态 p 和加入噪声后的测量值 m。然后调用 kf 函数得到滤波后的状态矩阵 f。

接下来，通过 OpenCV 绘制一个窗口，设置窗口大小，并创建一个白色背景的图像。然后在图像上绘制 x 和 y 轴，并为 x 和 y 轴添加刻度标签。接着使用不同颜色的线段分别绘制真实状态值、测量值和滤波后的状态值，并使用圆点标记测量值。最后将图像显示在窗口中。  
***参数调整：***卡尔曼滤波器中有一些关键参数，像过程噪声协方差矩阵 Q 和观测噪声协方差矩阵 R中的数字,其值的选择对图像中的滤波效果呈现有重要的影响，我经过调整分别得到噪声服从（0,1）分布和（0,10）分布的卡尔曼滤波图像。  
![图1+图2](https://github.com/SFUkjh/Myproject2/tree/main/%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/4.2.1)    
  

###2、     
二任务是构造一个二维匀速运动模型，只需要把对应的状态转移矩阵等改为二维的形式即可  
画出的图像，由于这里是在opencv的画布上，坐标系的正方向分别是向右和向下，因此画出的图有些阴间。。
其中卡尔曼滤波为蓝色线条，红色线条为观测值。

![二维kalman](https://github.com/SFUkjh/Myproject2/tree/main/%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/4.2.2)    
